# Image Type Documentation

## Purpose

The `Image` interface defines the fundamental structure for image objects throughout the application. It serves as a domain object that encapsulates the essential properties required to display images with proper accessibility support. This type ensures consistent image handling across components while enforcing accessibility best practices through required alt text.

## Type Definition

```typescript
export interface Image {
  src: string;
  alt: string;
}
```

### Properties

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `src` | `string` | ✅ | The image source URL or path to the image file |
| `alt` | `string` | ✅ | Alternative text description for accessibility and screen readers |

## Usage Examples

### Basic Image Component

```typescript
import { Image } from '@/lib/types/image';

interface ImageComponentProps {
  image: Image;
  className?: string;
}

function ImageComponent({ image, className }: ImageComponentProps) {
  return (
    <img 
      src={image.src} 
      alt={image.alt} 
      className={className}
    />
  );
}

// Usage
const profileImage: Image = {
  src: '/images/profile.jpg',
  alt: 'User profile photo showing a smiling person'
};

<ImageComponent image={profileImage} />
```

### Gallery Component with Image Array

```typescript
import { Image } from '@/lib/types/image';

interface GalleryProps {
  images: Image[];
}

function Gallery({ images }: GalleryProps) {
  return (
    <div className="grid grid-cols-3 gap-4">
      {images.map((image, index) => (
        <img 
          key={index}
          src={image.src} 
          alt={image.alt}
          className="w-full h-48 object-cover rounded"
        />
      ))}
    </div>
  );
}
```

### With TypeScript Utility Types

```typescript
import { Image } from '@/lib/types/image';

// Partial for optional updates
interface ImageUploadForm {
  image: Partial<Image>;
  onImageChange: (image: Partial<Image>) => void;
}

// Pick for selecting specific properties
type ImagePreview = Pick<Image, 'src'>;

// Extending the base interface
interface EnhancedImage extends Image {
  width?: number;
  height?: number;
  loading?: 'lazy' | 'eager';
}
```

## Type Architecture Pattern

### Domain Object Foundation
The `Image` interface serves as a **domain object** - the foundational building block in our type architecture:

```typescript
// 1. Domain Object (Current)
export interface Image {
  src: string;
  alt: string;
}
```

### Response Types (Built from Domain)
```typescript
// 2. API Response Types
export interface ImageUploadResponse {
  image: Image;
  uploadedAt: string;
  fileSize: number;
}

export interface GalleryResponse {
  images: Image[];
  totalCount: number;
  hasMore: boolean;
}
```

### Request Types (Composed from Domain)
```typescript
// 3. Request Types
export interface ImageUploadRequest {
  image: Omit<Image, 'src'>; // alt provided, src generated by server
  file: File;
}

export interface ImageUpdateRequest {
  imageData: Partial<Image>;
  imageId: string;
}
```

## Related Types

### Extended Image Interfaces

```typescript
// Enhanced image with metadata
interface ImageWithMetadata extends Image {
  id: string;
  uploadedAt: Date;
  fileSize: number;
  mimeType: string;
}

// Responsive image variant
interface ResponsiveImage extends Image {
  srcSet?: string;
  sizes?: string;
}

// Image with lazy loading
interface LazyImage extends Image {
  loading: 'lazy' | 'eager';
  placeholder?: string;
}
```

### Composite Types

```typescript
// User profile with image
interface UserProfile {
  id: string;
  name: string;
  avatar: Image;
}

// Article with featured image
interface Article {
  id: string;
  title: string;
  content: string;
  featuredImage: Image;
  gallery?: Image[];
}
```

## Integration Points

### Components
- `ImageComponent` - Basic image display
- `Gallery` - Image collections
- `ImageUpload` - File upload with preview
- `Avatar` - User profile images
- `ProductImage` - E-commerce product photos

### Services
- `ImageService` - Image upload and management
- `CDNService` - Image optimization and delivery
- `ValidationService` - Image validation before upload

### API Endpoints
- `POST /api/images/upload` - Accepts `ImageUploadRequest`
- `GET /api/images` - Returns `GalleryResponse`
- `PUT /api/images/:id` - Accepts `ImageUpdateRequest`

## Validation

### Zod Schema

```typescript
import { z } from 'zod';

export const ImageSchema = z.object({
  src: z.string().url('Must be a valid URL').min(1, 'Image source is required'),
  alt: z.string().min(1, 'Alt text is required for accessibility').max(200, 'Alt text too long')
});

// Usage in forms
export type ImageFormData = z.infer<typeof ImageSchema>;

// Validation function
export function validateImage(image: unknown): Image {
  return ImageSchema.parse(image);
}

// Safe validation with error handling
export function safeValidateImage(image: unknown): { success: boolean; data?: Image; error?: string } {
  const result = ImageSchema.safeParse(image);
  return result.success 
    ? { success: true, data: result.data }
    : { success: false, error: result.error.message };
}
```

### Runtime Validation Example

```typescript
function processImageUpload(imageData: unknown): Image {
  try {
    return validateImage(imageData);
  } catch (error) {
    throw new Error(`Invalid image data: ${error.message}`);
  }
}
```

## Best Practices

### ✅ Adherence to TypeScript Guidelines

1. **Strict Typing**: Uses explicit `string` types, no `any` usage
2. **Interface over Type**: Correctly uses `interface` for object shape definition
3. **Domain Object Pattern**: Serves as foundation for building other types
4. **Accessibility First**: Enforces required `alt` text for screen readers

### ✅ Recommended Patterns

```typescript
// Good: Extend the base interface
interface ProductImage extends Image {
  productId: string;
  isFeature: boolean;
}

// Good: Use utility types for variations
type OptionalImage = Partial<Image>;
type ImageSource = Pick<Image, 'src'>;

// Good: Compose with other domain objects
interface ImageGallery {
  title: string;
  images: Image[];
  createdAt: Date;
}
```

### ❌ Anti-Patterns to Avoid

```typescript
// Bad: Using 'any'
interface BadImage {
  src: any;
  alt: any;
}

// Bad: Optional alt text (breaks accessibility)
interface InaccessibleImage {
  src: string;
  alt?: string; // Alt should always be required
}

// Bad: Using 'type' for object shapes
type ImageType = {
  src: string;
  alt: string;
}; // Should use interface instead
```

### Performance Considerations

```typescript
// Optimize for large image collections
interface OptimizedImageList {
  images: readonly Image[]; // Immutable for better performance
  lazyLoad: boolean;
}

// Memory-efficient image loading
interface LazyLoadImage extends Image {
  loading: 'lazy';
  placeholder: string; // Low-res placeholder
}
```

This `Image` type serves as a robust foundation for image handling throughout the application, ensuring accessibility compliance while maintaining type safety and extensibility.